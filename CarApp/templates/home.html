{% extends "base.html" %}
{% load static %}
{% block title %}{% endblock %}


{% block custom-style%}

{% endblock %}
{% block content %}
    {% if not user.is_authenticated %}
        <div class="login-container">
                <form method="POST" action= "{% url 'login-staff'%}"class="login-form" >
                    {% csrf_token %} 
                    <h2 class="login-form-title">LOGIN</h2>
                    <input type="text" placeholder="Enter Username" name="username" class="login-field" required>
                    <input type="text" placeholder="Enter Password" name="password" class="login-field"  required>
                    {% if messages %}
                        {% for message in messages %}
                            <p class="messages">{{message}}</p>
                        {% endfor %}
                    {% endif %}
                    <button type="submit" class="login-field submit-btn login-btn">Login</button> 
                </form>
        </div>
    {% else %}
        <h2 class="cart-header">DASHBOARD</h2>
        <form method="POST" action="{% url 'dashboard' %}">
            {% csrf_token %}
            <div class="pending-search-by-container">
                {% if search_by %}
                    <input type="text" value="{{search_by}}" list="search-by" name="search-by" class="search-by">
                {% else %}
                    <input type="text" placeholder="Select query" list="search-by" name="search-by" class="search-by">
                {%endif%}
                <datalist id="search-by">
                    <option value="Cars available for sale">
                    <option value="Sales by date">
                    <option value="Sales by staff member">
                    <option value="Total sales revenue">
                    <option value="Cars with upcoming services">
                    <option value="Cars with past services">
                    <option value="Customer purchase history">
                </datalist>

                {% if date %}
                    <input type="date" name="date" value={{date}} class="search-by-date">
                {% else %}
                    <input type="date" name="date" class="search-by-date">
                {% endif %}

                {% if query %}
                    <input type="text" placeholder="enter customer/staff ID" value={{query}} name="query" class="search-by-others customer-id">
                {% else %}
                    <input type="text" placeholder="enter customer/staff ID" name="query" class="search-by-others customer-id">
                {% endif %}

                <button class="run-query-btn" type="submit">RUN</button>
            </div>
        {% if messages %}
            {% for message in messages %}
                <p class="pending-order-messages">{{message}}</p>
            {% endfor %}
        {% endif %}
        </form>

        {% block query_table %}


            <div class="cart-container pending-orders-container">
      
  
                        {% if not total_sales and not past and not upcoming %}
                            <div class="cart-column-headers-container">
                                <p class="cart-column-headers">Sales ID</p>
                                <p class="cart-column-headers">Car ID</p>
                                <p class="cart-column-headers">Customer ID</p>
                                <p class="cart-column-headers">Staff ID</p>
                                <p class="cart-column-headers">Sales Date</p>
                                <p class="cart-column-headers">Sales Price(&pound)</p>
                                <p class="cart-column-headers">Payment Method</p>
                            </div>
                        {% elif past or upcoming %}
                            <div class="service-home-headers-container">
                                <p class="cart-column-headers">Service ID</p>
                                <p class="cart-column-headers">Car ID</p>
                                <p class="cart-column-headers">Staff ID</p>
                                <p class="cart-column-headers">Date</p>
                                <p class="cart-column-headers">Type</p>
                                <p class="cart-column-headers">Cost</p>
                            </div>
                        {% endif %}

                        {% if 'all_sales'%}
                            {% for sale in all_sales %}
                                <div class="cart-items-container">
                                    <div>{{sale.sales_id}}</div>
                                    <div>{{sale.car_id}}</div>
                                    <div>{{sale.customer_id}}</div>
                                    <div>{{sale.staff_id}}</div>
                                    <div>{{sale.sales_date}}</div>
                                    <div>{{sale.sales_price}}</div>
                                    <div>{{sale.payment_method}}</div>
                            
                                </div>
                            {% endfor%}
                            {% if counter == 4 %}
                                <div class="cart-items-container"></div>
                            {% endif %}
                            {% if counter == 3 %}
                                <div class="cart-items-container"></div>
                                <div class="cart-items-container"></div>
                            {% endif %}
                            {% if counter == 2 %}
                                <div class="cart-items-container"></div>
                                <div class="cart-items-container"></div>
                                <div class="cart-items-container"></div>
                            {% endif %}
                            {% if counter == 1 %}
                                <div class="cart-items-container"></div>
                                <div class="cart-items-container"></div>
                                <div class="cart-items-container"></div>
                                <div class="cart-items-container"></div>
                            {% endif %}

                        {% endif %}

                        {% if 'customer_purchases'%}
                            {% for sale in customer_purchases %}
                                <div class="cart-items-container">
                                    <div>{{sale.sales_id}}</div>
                                    <div>{{sale.car_id}}</div>
                                    <div>{{sale.customer_id}}</div>
                                    <div>{{sale.staff_id}}</div>
                                    <div>{{sale.sales_date}}</div>
                                    <div>{{sale.sales_price}}</div>
                                    <div>{{sale.payment_method}}</div>
                            
                                </div>
                            {% endfor%}

                        {% endif %}

                        {% if 'sales_by_date'%}
                            {% for sale in sales_by_date%}
                                <div class="cart-items-container">
                                    <div>{{sale.sales_id}}</div>
                                    <div>{{sale.car_id}}</div>
                                    <div>{{sale.customer_id}}</div>
                                    <div>{{sale.staff_id}}</div>
                                    <div>{{sale.sales_date}}</div>
                                    <div>{{sale.sales_price}}</div>
                                    <div>{{sale.payment_method}}</div>
                            
                                </div>
                            {% endfor%}

                        {% endif %}

                        {% if 'sales_by_staff' %}
                            {% for sale in sales_by_staff %}
                                <div class="cart-items-container">
                                    <div>{{sale.sales_id}}</div>
                                    <div>{{sale.car_id}}</div>
                                    <div>{{sale.customer_id}}</div>
                                    <div>{{sale.staff_id}}</div>
                                    <div>{{sale.sales_date}}</div>
                                    <div>{{sale.sales_price}}</div>
                                    <div>{{sale.payment_method}}</div>
                            
                                </div>
                            {% endfor%}

                        {% endif %}
                        {% if 'past' %}
                            {% for service in past %}
                                <div class="car-items-container cart-items-container service-items-container">
                                    <div>{{service.service_id}}</div>
                                    <div>{{service.car_id}}</div>
                                    <div>{{service.staff_id}}</div>
                                    <div>{{service.service_date}}</div>
                                    <div>{{service.service_type}}</div>
                                    <div>{{service.service_cost}}</div>
                                </div>
                            {% endfor%}
                        {% endif  %}
                        {% if 'upcoming' %}
                            {% for service in upcoming %}
                                <div class="car-items-container cart-items-container service-items-container">
                                    <div>{{service.service_id}}</div>
                                    <div>{{service.car_id}}</div>
                                    <div>{{service.staff_id}}</div>
                                    <div>{{service.service_date}}</div>
                                    <div>{{service.service_type}}</div>
                                    <div>{{service.service_cost}}</div>
                                </div>
                            {% endfor%}
                        {% endif %} 
            
            </div>
            {% if all_sales %}
                <div class="pagination">
                    {% if all_sales.has_previous %}
                        <a href="?page={{ all_sales.previous_page_number }} " class="pagination-control">Previous</a>
                    {% endif %}
                    {% if all_sales %}
                    <span> {{ all_sales.number }} of {{ all_sales.paginator.num_pages }} </span>
                    {% endif %}
                    {% if all_sales.has_next %}
                        <a href="?page={{ all_sales.next_page_number }}" class="pagination-control">Next</a>
                    {% endif %}
                </div>
            {% endif %}    
        {% endblock%}
    {% endif %}           
{% endblock %}

